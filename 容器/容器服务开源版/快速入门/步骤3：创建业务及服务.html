<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>操作场景 | 文档中心</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/documents/assets/css/0.styles.87784391.css" as="style"><link rel="preload" href="/documents/assets/js/app.38cb63d0.js" as="script"><link rel="preload" href="/documents/assets/js/2.63e8fc97.js" as="script"><link rel="preload" href="/documents/assets/js/19.787e1b48.js" as="script"><link rel="prefetch" href="/documents/assets/js/10.5b4697ea.js"><link rel="prefetch" href="/documents/assets/js/11.8293da54.js"><link rel="prefetch" href="/documents/assets/js/12.0178cde1.js"><link rel="prefetch" href="/documents/assets/js/13.ffcc2f9f.js"><link rel="prefetch" href="/documents/assets/js/14.f5274e4e.js"><link rel="prefetch" href="/documents/assets/js/15.c32fdacc.js"><link rel="prefetch" href="/documents/assets/js/16.a3317ffa.js"><link rel="prefetch" href="/documents/assets/js/17.a346ab28.js"><link rel="prefetch" href="/documents/assets/js/18.4ad57b77.js"><link rel="prefetch" href="/documents/assets/js/20.89366f41.js"><link rel="prefetch" href="/documents/assets/js/21.7a4d56a5.js"><link rel="prefetch" href="/documents/assets/js/22.84a1e77a.js"><link rel="prefetch" href="/documents/assets/js/23.20225c84.js"><link rel="prefetch" href="/documents/assets/js/24.65bf0d09.js"><link rel="prefetch" href="/documents/assets/js/25.5211e519.js"><link rel="prefetch" href="/documents/assets/js/26.e9fc313f.js"><link rel="prefetch" href="/documents/assets/js/3.a13bede0.js"><link rel="prefetch" href="/documents/assets/js/4.ba3164ba.js"><link rel="prefetch" href="/documents/assets/js/5.01799cc0.js"><link rel="prefetch" href="/documents/assets/js/6.0377ba0c.js"><link rel="prefetch" href="/documents/assets/js/7.e59ee139.js"><link rel="prefetch" href="/documents/assets/js/8.52dec0b1.js"><link rel="prefetch" href="/documents/assets/js/9.bbb5d350.js">
    <link rel="stylesheet" href="/documents/assets/css/0.styles.87784391.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documents/" class="home-link router-link-active"><!----> <span class="site-name">文档中心</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/Skeletons4/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/Skeletons4/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>快速入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/documents/容器/容器服务开源版/快速入门/TKEStack快速入门.html" class="sidebar-link">操作场景</a></li><li><a href="/documents/容器/容器服务开源版/快速入门/概述.html" class="sidebar-link">/容器/容器服务开源版/快速入门/概述.html</a></li><li><a href="/documents/容器/容器服务开源版/快速入门/步骤1：控制台安装.html" class="sidebar-link">操作场景</a></li><li><a href="/documents/容器/容器服务开源版/快速入门/步骤2：创建及导入集群.html" class="sidebar-link">操作场景</a></li><li><a href="/documents/容器/容器服务开源版/快速入门/步骤3：创建业务及服务.html" class="active sidebar-link">操作场景</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/容器/容器服务开源版/快速入门/步骤3：创建业务及服务.html#操作场景" class="sidebar-link">操作场景</a></li><li class="sidebar-sub-header"><a href="/documents/容器/容器服务开源版/快速入门/步骤3：创建业务及服务.html#前提条件" class="sidebar-link">前提条件</a></li><li class="sidebar-sub-header"><a href="/documents/容器/容器服务开源版/快速入门/步骤3：创建业务及服务.html#操作步骤" class="sidebar-link">操作步骤</a></li><li class="sidebar-sub-header"><a href="/documents/容器/容器服务开源版/快速入门/步骤3：创建业务及服务.html#相关操作" class="sidebar-link">相关操作</a></li></ul></li><li><a href="/documents/容器/容器服务开源版/快速入门/步骤4：删除资源.html" class="sidebar-link">操作场景</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="操作场景"><a href="#操作场景" class="header-anchor">#</a> 操作场景</h2> <p>本文介绍如何通过 TKE Stack 控制台，在已有集群下创建业务或服务。</p> <h2 id="前提条件"><a href="#前提条件" class="header-anchor">#</a> 前提条件</h2> <p>已参考 <a href="https://cloud.tencent.com/document/product/1205/43565" target="_blank" rel="noopener noreferrer">创建及导入集群<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 成功创建集群。</p> <h2 id="操作步骤"><a href="#操作步骤" class="header-anchor">#</a> 操作步骤</h2> <h3 id="创建业务"><a href="#创建业务" class="header-anchor">#</a> 创建业务</h3> <ol><li>登录 TKE Stack 控制台，选择左侧导航栏中的【业务管理】。</li> <li>在“业务管理”列表页面，单击【新建业务】。</li> <li>在“新建业务”页面，参考以下提示设置业务信息。如下图所示：
<img src="https://main.qcloudimg.com/raw/acdeddc50f4840da9fdccaea25f86569.png" alt=""></li></ol> <ul><li><strong>业务名称</strong>：自定义业务名称，不能超过63个字符。</li> <li><strong>业务成员</strong>：“用户管理”列表中已存在的用户。</li> <li><strong>集群</strong>：“集群管理”列表中已创建的集群。</li> <li><strong>上级业务</strong>：支持多级业务管理，可不选。</li></ul> <ol start="4"><li>单击【完成】即可创建业务。</li></ol> <h3 id="创建服务"><a href="#创建服务" class="header-anchor">#</a> 创建服务</h3> <blockquote><p>!由于Master 节点的预设置，请参考 <a href="#addNode">添加节点</a> 步骤，向集群中增加节点后再创建服务。</p></blockquote> <ol><li>选择左侧导航栏中的【集群管理】，进入“集群管理”列表页面。</li> <li>选择需创建服务的集群 ID，进入该集群 “Deployment” 页面并单击【新建】。</li> <li>在 “新建Workload” 页面，参考以下信息设置 Deployment 参数。如下图所示：
<img src="https://main.qcloudimg.com/raw/126e1db83a90ce4a7f560c6abb8991ca.png" alt="">
主要参数信息如下：
<ul><li><strong>工作负载名</strong>：输入自定义名称，最长63个字符，只能包含小写字母、数字及分隔符 <code>-</code>，且必须以小写字母开头，数字或小写字母结尾。</li> <li><strong>命名空间</strong>：根据实际需求进行选择。</li> <li><strong>类型</strong>：选择【Deployment（可扩展的部署 Pod）】。</li></ul></li> <li>如需指定容器挂载至指定路径时，单击【添加数据卷】，并根据以下信息设置。如下图所示：
<img src="https://main.qcloudimg.com/raw/2d971c8e615df80264849340ece5f64a.png" alt=""> <ul><li><strong>使用临时目录</strong>：主机的临时目录，生命周期和 Pod 一致。</li> <li><strong>使用主机路径</strong>：主机的真实路径，可以重复使用，不会随 Pod 一起销毁。</li> <li><strong>使用NFS盘</strong>：挂载外部 NFS 到 Pod，用户需要指定相应 NFS 地址。例如，<code>127.0.0.1:/data</code>。</li> <li><strong>使用已有PVC</strong>：可选择在业务 Namespace 下的 PVC。</li> <li><strong>使用ConfigMap</strong>：可选择在业务 Namespace 下的 ConfigMap。</li> <li><strong>使用Secret</strong>：可选择在业务 Namespace 下的 Secret。</li></ul></li> <li>根据实际需求，为 Deployment 的一个 Pod 设置一个或多个不同的容器。如下图所示：
<img src="https://main.qcloudimg.com/raw/a2b6b32ec9723bca7a53699719d63256.png" alt="">
主要参数信息如下：</li></ol> <ul><li><strong>名称</strong>：自定义名称，最长63个字符，只能包含小写字母、数字及分隔符 <code>-</code>，且不能以分隔符开头或结尾。</li> <li><strong>镜像</strong>：根据实际需求进行填写。</li> <li><strong>镜像版本（Tag）</strong>：根据实际需求进行填写。</li> <li><strong>CPU/内存限制</strong>：可根据 <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/" target="_blank" rel="noopener noreferrer">Kubernetes 资源限制<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行设置 CPU 和内存的限制范围，提高业务的健壮性。</li> <li><strong>显示高级设置</strong>：可设置“工作目录”、“运行命令”、“运行参数”、“容器健康检查”和“特权级”等参数。</li></ul> <ol start="8"><li>参考以下信息设置实例数量。如下图所示：
<img src="https://main.qcloudimg.com/raw/43db545ddcdbd13752b18221550c269a.png" alt=""></li></ol> <ul><li><strong>实例数量</strong>：根据实际需求选择调节方式，设置实例数量。
<ul><li><strong>手动调节</strong>：直接设定实例个数。</li> <li><strong>自动调节</strong>：根据设定的触发条件自动调节实例个数。目前支持根据 CPU、内存利用率和利用量出入带宽等调节实例个数。</li></ul></li> <li><strong>定时调节</strong>：根据 Crontab 语法周期性设置实例个数。</li></ul> <ol start="9"><li>单击【显示高级设置】，并参考以下信息进行设置。如下图所示：
<img src="https://main.qcloudimg.com/raw/24e2289886c3187857a321b1e33a482d.png" alt=""> <ul><li><strong>imagePullSecrets</strong>：镜像拉取密钥，用于拉取用户的私有镜像。</li> <li><strong>节点调度策略</strong>：根据配置的调度规则，将 Pod 调度到预期的节点。</li> <li><strong>注释（Annotations）</strong>：给 Pod 添加相应 Annotation，例如用户信息等。</li> <li><strong>网络模式</strong>：Pod 网络模式，根据以下信息进行设置：</li> <li><strong>OverLay（虚拟网络）</strong>：基于 IPIP 和 Host Gateway 的 Overlay 网络方案。</li> <li><strong>FloatingIP（浮动 IP）</strong>：支持容器、物理机和虚拟机在同一个扁平面中直接通过 IP 进行通信的 Underlay 网络方案。提供了 IP 漂移能力，支持 Pod 重启或迁移时 IP 不变。</li> <li><strong>NAT（端口映射）</strong>：Kubernetes 原生 NAT 网络方案。</li> <li><strong>Host（主机网络）</strong>：Kubernetes 原生 Host 网络方案。</li></ul></li> <li>参考以下信息进行访问设置。如下图所示：
<img src="https://main.qcloudimg.com/raw/c56bb37f4510c9703ff87e8930647d05.png" alt=""> <ul><li><strong>Service</strong>：勾选【启用】按钮，配置负载端口访问。</li> <li><strong>服务访问方式</strong>：</li> <li><strong>仅在集群内访问</strong>：将提供一个可以被集群内其他服务或容器访问的入口，支持 TCP/UDP 协议。数据库类服务如 MySQL 可选择此方式，来保证服务网络隔离性。</li> <li><strong>主机端口访问</strong>：提供一个主机端口映射到容器的访问方式，支持 TCP/UDP 协议，可用于业务定制上层负载均衡转发到 Node。</li> <li><strong>Headless Service</strong>：解析域名时返回相应 Pod IP 而不是 Cluster IP。<strong>创建完成后不支持变更访问方式</strong>。</li> <li><strong>端口映射</strong>：输入负载要暴露的端口并指定通信协议类型。</li></ul></li> <li>单击【创建Workload】即可完成创建。
当运行数量=期望数量时，即表示 Deployment 下的所有 Pod 已创建完成。如下图所示：
<img src="https://main.qcloudimg.com/raw/7677b741d306407c74c082fa43c6c697.png" alt=""></li></ol> <h2 id="相关操作"><a href="#相关操作" class="header-anchor">#</a> 相关操作</h2> <h3 id="添加节点"><a href="#添加节点" class="header-anchor">#</a> 添加节点<span id="addNode"></span></h3> <ol><li>登录 TKE Stack 控制台，选择左侧导航栏中的【集群管理】。</li> <li>选择需创建服务的集群 ID，进入该集群 “Deployment” 页面。</li> <li>选择左侧菜单栏中的【节点管理】&gt;【节点】，进入“节点列表”页面。</li> <li>在“节点列表”页面，选择【添加节点】。如下图所示：
<img src="https://main.qcloudimg.com/raw/922b1f24f8dba95c03105f0af32a0f58.png" alt=""></li> <li>在“添加节点页面”，参考以下信息进行设置。
<ul><li><strong>目标机器</strong>：Master&amp;Etcd 节点的内网 IP，建议节点配置4核及以上机型。</li> <li><strong>SSH端口</strong>：请确保目标机器安全组放通22端口和 ICMP 协议，否则无法远程登录和 Ping 通。</li> <li><strong>主机label</strong>：设置主机 Label，可用于指定容器调度。</li> <li><strong>认证方式</strong>：
<ul><li><strong>密码认证</strong>：目标机器密码。</li> <li><strong>密钥认证</strong>：
<ul><li><strong>私钥</strong>：目标机器私钥。</li> <li><strong>私钥密码</strong>：目标机器私钥密码，可选填。</li></ul></li></ul></li> <li><strong>GPU</strong>：目标机器是否为 GPU 机型，使用 GPU 机器需提前安装驱动和 runtime。</li></ul></li> <li>单击【提交】即可在“节点列表”页面查看进度。
如下图所示，则为添加成功：
<img src="https://main.qcloudimg.com/raw/ad3bcb295cc717980b9aecfa86914985.png" alt=""></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Skeletons4/documents/edit/master/docs/容器/容器服务开源版/快速入门/步骤3：创建业务及服务.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/documents/容器/容器服务开源版/快速入门/步骤2：创建及导入集群.html" class="prev">
        操作场景
      </a></span> <span class="next"><a href="/documents/容器/容器服务开源版/快速入门/步骤4：删除资源.html">
        操作场景
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/documents/assets/js/app.38cb63d0.js" defer></script><script src="/documents/assets/js/2.63e8fc97.js" defer></script><script src="/documents/assets/js/19.787e1b48.js" defer></script>
  </body>
</html>
