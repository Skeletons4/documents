<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>操作场景</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.83d5dd80.js" as="script"><link rel="preload" href="/assets/js/2.dd3e4e7e.js" as="script"><link rel="preload" href="/assets/js/13.658fefc0.js" as="script"><link rel="prefetch" href="/assets/js/10.5137b374.js"><link rel="prefetch" href="/assets/js/11.4262532f.js"><link rel="prefetch" href="/assets/js/12.6dae9ec3.js"><link rel="prefetch" href="/assets/js/14.10ea1211.js"><link rel="prefetch" href="/assets/js/15.6404a911.js"><link rel="prefetch" href="/assets/js/16.56bea069.js"><link rel="prefetch" href="/assets/js/17.0cf52a15.js"><link rel="prefetch" href="/assets/js/18.9089aff0.js"><link rel="prefetch" href="/assets/js/19.11f6e719.js"><link rel="prefetch" href="/assets/js/20.d1beb67c.js"><link rel="prefetch" href="/assets/js/21.adc2c0c3.js"><link rel="prefetch" href="/assets/js/22.77a850be.js"><link rel="prefetch" href="/assets/js/23.84aff4a4.js"><link rel="prefetch" href="/assets/js/24.477aa370.js"><link rel="prefetch" href="/assets/js/25.d9759363.js"><link rel="prefetch" href="/assets/js/3.3a852c24.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.428f33fc.js"><link rel="prefetch" href="/assets/js/8.0d498a92.js"><link rel="prefetch" href="/assets/js/9.37bd2a66.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="操作场景"><a href="#操作场景" class="header-anchor">#</a> 操作场景</h2> <p>本文档介绍如何快速创建一个基于容器服务开源版（TKEStack）集群内的 Nginx 服务。</p> <h2 id="前提条件"><a href="#前提条件" class="header-anchor">#</a> 前提条件</h2> <ul><li>已部署 TKEStack 控制台，详情请参见 <a href="https://cloud.tencent.com/document/product/1205/43828#.E6.AD.A5.E9.AA.A41.EF.BC.9A.E6.8E.A7.E5.88.B6.E5.8F.B0.E5.AE.89.E8.A3.85" target="_blank" rel="noopener noreferrer">控制台安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>已创建集群，详情请参见 <a href="https://cloud.tencent.com/document/product/1205/43828#.E6.AD.A5.E9.AA.A42.EF.BC.9A.E6.96.B0.E5.BB.BA.E7.8B.AC.E7.AB.8B.E9.9B.86.E7.BE.A4" target="_blank" rel="noopener noreferrer">新建独立集群<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>由于 Master 节点的预设置，请参考 <a href="https://cloud.tencent.com/document/product/1205/43828#addNode" target="_blank" rel="noopener noreferrer">添加节点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 步骤，向集群中增加节点后再创建服务。</li></ul> <h2 id="操作步骤"><a href="#操作步骤" class="header-anchor">#</a> 操作步骤</h2> <h3 id="创建-nginx-服务"><a href="#创建-nginx-服务" class="header-anchor">#</a> 创建 Nginx 服务</h3> <ol><li>登录 TKEStack 控制台，选择左侧导航栏中的【集群管理】。</li> <li>在“集群管理”列表页面，选择需创建服务的集群 ID。</li> <li>在集群的 “Deployment” 页面，单击【新建】。如下图所示：
<img src="https://main.qcloudimg.com/raw/3199122e5925c79e020c8429488a0732.png" alt=""></li> <li>在 “新建Workload” 页面，根据以下提示，设置工作负载基本信息。如下图所示：
<img src="https://main.qcloudimg.com/raw/cb89bcbd9bbcd5d11f584a485eb60a0b.png" alt=""></li></ol> <ul><li><strong>工作负载名</strong>：输入要创建的工作负载的名称，本文以 nginx 为例。</li> <li><strong>描述</strong>：填写工作负载的相关信息。</li> <li><strong>标签</strong>：key = value 键值对，本例中标签默认值为 k8s-app = <strong>nginx</strong>。</li> <li><strong>命名空间</strong>：根据实际需求进行选择。</li> <li><strong>类型</strong>：根据实际需求进行选择。</li> <li><strong>数据卷</strong>：根据实需求设置工作负载的挂载卷。</li></ul> <ol start="5"><li>在“实例内容器”中，参考以下信息进行设置。如下图所示：
<img src="https://main.qcloudimg.com/raw/fe2ac9a5c76e55401395db600d43306f.png" alt="">
主要参数信息如下：
<ul><li><strong>名称</strong>：输入实例内容器名称，本文以 nginx 为例。</li> <li><strong>镜像</strong>：输入镜像地址，本文以 nginx 为例。</li> <li><strong>镜像版本（Tag）</strong>：使用的镜像版本，本为以 <code>latest</code> 为例。
其余参数请保持默认设置。</li></ul></li> <li>在“实例数量”中，参考以下信息设置服务的实例数量。如下图所示：
<img src="https://main.qcloudimg.com/raw/24fd3b152d94f5ca2f7170dc06e3eeda.png" alt=""></li></ol> <ul><li><strong>手动调节</strong>：设定实例数量，本文实例数量设置为1。可单击<code>+</code>或<code>-</code>控制实例数量。</li> <li><strong>自动调节</strong>：满足任一设定条件，则自动调节实例（pod）数目。</li></ul> <ol start="7"><li>根据以下提示，进行工作负载的访问设置。如下图所示：<br> <img src="https://main.qcloudimg.com/raw/afda7a549dd4ebf554c9acbb5c9ea6a8.png" alt=""></li></ol> <ul><li><strong>Service</strong>：勾选“启用”。</li> <li><strong>服务访问方式</strong>：选择“主机端口访问”。</li> <li><strong>端口映射</strong>：选择 TCP 协议，容器端口和服务端口都设置为80 ，主机端口设置为30000。</li></ul> <blockquote><p>!服务所在集群的安全组需要放通节点网络及容器网络，同时需要放通30000 - 32768端口，否则可能会出现容器服务无法使用问题。</p></blockquote> <ol start="8"><li>单击【创建Workload】，完成 Nginx 服务的创建。</li></ol> <h3 id="访问-nginx-服务"><a href="#访问-nginx-服务" class="header-anchor">#</a> 访问 Nginx 服务</h3> <p>可通过以下两种方式访问 Nginx 服务。</p> <h4 id="通过主机节点端口访问-nginx-服务"><a href="#通过主机节点端口访问-nginx-服务" class="header-anchor">#</a> 通过主机节点端口访问 Nginx 服务</h4> <ol><li>单击左侧导航栏中【集群管理】，进入该集群的 “Deployment” 页面。</li> <li>选择左侧菜单栏中的【服务】&gt;【Service】，进入 “Service” 页面。</li> <li>在 “Service” 页面，可查看 Nginx Service 正在运行，如下图所示：
<img src="https://main.qcloudimg.com/raw/549822715d1cd7eb35619570fadd9f87.png" alt=""></li> <li>在浏览器地址栏访问集群任意节点 IP 的30000端口即可访问服务。</li></ol> <h4 id="通过服务名称访问-nginx-服务"><a href="#通过服务名称访问-nginx-服务" class="header-anchor">#</a> 通过服务名称访问 Nginx 服务</h4> <p>集群内的其他服务或容器可以直接通过服务名称访问。</p> <h3 id="验证-nginx-服务"><a href="#验证-nginx-服务" class="header-anchor">#</a> 验证 nginx 服务</h3> <p>服务创建成功，访问服务时直接进入 Nginx 服务器的默认欢迎页。如下图所示：
<img src="https://main.qcloudimg.com/raw/c2aa05dcabba7b9c8a9a49e258e65111.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.83d5dd80.js" defer></script><script src="/assets/js/2.dd3e4e7e.js" defer></script><script src="/assets/js/13.658fefc0.js" defer></script>
  </body>
</html>
